package com.demo.controllers;

import java.util.Arrays;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.ParameterizedTypeReference;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpMethod;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;

import com.flightapp.entities.Cinema;


@RestController
@RequestMapping("/cinemas")
public class CinemaController {
    // localhost:8989/shows/cinemas

    @Autowired
    private RestTemplate restTemplate;

    // @GetMapping("")
    // public List<String> getMovies(){
    //     return Arrays.asList("Superman is back", "Batman is in day", "Ironman with plastic");
    // }

    @GetMapping("")
    public List<Cinema> getMovies(){
        // http://192.168.1.41:52429/api/v1/movies

        // restTemplate.exchange(url, method, entity, responseType)
        ResponseEntity<List<Cinema>> res = restTemplate.exchange(
            "http://MOVIES/api/v1/movies", 
            HttpMethod.GET, 
            new HttpEntity(null), 
            new ParameterizedTypeReference<List<Cinema>>() {}
        );

        return res.getBody();
    }

}